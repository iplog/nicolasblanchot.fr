/**
 * almond 0.1.1 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/**
 * @license RequireJS text 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * iScroll v4.1.9 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

(function(){var requirejs,require,define;(function(undef){function normalize(name,baseName){var baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{},nameParts,nameSegment,mapValue,foundMap,i,j,part;if(name&&name.charAt(0)==="."&&baseName){baseParts=baseParts.slice(0,baseParts.length-1),name=baseParts.concat(name.split("/"));for(i=0;part=name[i];i++)if(part===".")name.splice(i,1),i-=1;else if(part===".."){if(i===1&&(name[2]===".."||name[0]===".."))return!0;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts)for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;break}}}foundMap=foundMap||starMap[nameSegment];if(foundMap){nameParts.splice(0,i,foundMap),name=nameParts.join("/");break}}}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(waiting.hasOwnProperty(name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!defined.hasOwnProperty(name))throw new Error("No "+name);return defined[name]}function makeMap(name,relName){var prefix,plugin,index=name.indexOf("!");return index!==-1?(prefix=normalize(name.slice(0,index),relName),name=name.slice(index+1),plugin=callDep(prefix),plugin&&plugin.normalize?name=plugin.normalize(name,makeNormalize(relName)):name=normalize(name,relName)):name=normalize(name,relName),{f:prefix?prefix+"!"+name:name,n:name,p:plugin}}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var defined={},waiting={},config={},defining={},aps=[].slice,main,req;main=function(name,deps,callback,relName){var args=[],usingExports,cjsModule,depName,ret,map,i;relName=relName||name;if(typeof callback=="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i++){map=makeMap(deps[i],relName),depName=map.f;if(depName==="require")args[i]=makeRequire(name);else if(depName==="exports")args[i]=defined[name]={},usingExports=!0;else if(depName==="module")cjsModule=args[i]={id:name,uri:"",exports:defined[name],config:makeConfig(name)};else if(defined.hasOwnProperty(depName)||waiting.hasOwnProperty(depName))args[i]=callDep(depName);else if(map.p)map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName];else if(!defining[depName])throw new Error(name+" missing "+depName)}ret=callback.apply(defined[name],args);if(name)if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name])defined[name]=cjsModule.exports;else if(ret!==undef||!usingExports)defined[name]=ret}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync){return typeof deps=="string"?callDep(makeMap(deps,callback).f):(deps.splice||(config=deps,callback.splice?(deps=callback,callback=relName,relName=null):deps=undef),callback=callback||function(){},forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},15),req)},req.config=function(cfg){return config=cfg,req},define=function(name,deps,callback){deps.splice||(callback=deps,deps=[]),waiting[name]=[name,deps,callback]},define.amd={jQuery:!0}})(),define("../js/requirejs/almond",function(){}),define("domReady",[],function(){function runCallbacks(callbacks){var i;for(i=0;i<callbacks.length;i++)callbacks[i](doc)}function callReady(){var callbacks=readyCalls;isPageLoaded&&callbacks.length&&(readyCalls=[],runCallbacks(callbacks))}function pageLoaded(){isPageLoaded||(isPageLoaded=!0,scrollIntervalId&&clearInterval(scrollIntervalId),callReady())}function domReady(callback){return isPageLoaded?callback(doc):readyCalls.push(callback),domReady}var isBrowser=typeof window!="undefined"&&window.document,isPageLoaded=!isBrowser,doc=isBrowser?document:null,readyCalls=[],isTop,testDiv,scrollIntervalId;if(isBrowser){if(document.addEventListener)document.addEventListener("DOMContentLoaded",pageLoaded,!1),window.addEventListener("load",pageLoaded,!1);else if(window.attachEvent){window.attachEvent("onload",pageLoaded),testDiv=document.createElement("div");try{isTop=window.frameElement===null}catch(e){}testDiv.doScroll&&isTop&&window.external&&(scrollIntervalId=setInterval(function(){try{testDiv.doScroll(),pageLoaded()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&pageLoaded()}return domReady.version="2.0.0",domReady.load=function(name,req,onLoad,config){config.isBuild?onLoad(null):domReady(onLoad)},domReady}),define("text",["module"],function(module){var progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!="undefined"&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap=[],masterConfig=module.config(),text,fs;return text={version:"2.0.0",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(i=0;i<3;i++){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var strip=!1,index=name.indexOf("."),modName=name.substring(0,index),ext=name.substring(index+1,name.length);return index=ext.indexOf("!"),index!==-1&&(strip=ext.substring(index+1,ext.length),strip=strip==="strip",ext=ext.substring(0,index)),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var match=text.xdRegExp.exec(url),uProtocol,uHostName,uPort;return match?(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName===hostname)&&(!uPort&&!uHostName||uPort===port)):!0},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText){onLoad();return}masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+"."+parsed.ext,url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),nonStripName=parsed.moduleName+"."+parsed.ext,fileName=req.toUrl(parsed.moduleName+"."+parsed.ext)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}},typeof process!="undefined"&&process.versions&&!!process.versions.node?(fs=require.nodeRequire("fs"),text.get=function(url,callback){var file=fs.readFileSync(url,"utf8");file.indexOf("ï»¿")===0&&(file=file.substring(1)),callback(file)}):text.createXhr()?text.get=function(url,callback,errback){var xhr=text.createXhr();xhr.open("GET",url,!0),masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText))},xhr.send(null)}:typeof Packages!="undefined"&&(text.get=function(url,callback){var encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),stringBuffer,line,content="";try{stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&line.charAt(0)===65279&&(line=line.substring(1)),stringBuffer.append(line);while((line=input.readLine())!==null)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)}),text}),define("text!templates/CategoriesTmpl.html",[],function(){return'<div class="toolbar">\n  <h1>{{title}}</h1>\n</div>\n<div class="wrapper">\n  <div class="scrollable">\n    <ul>\n    </ul>\n  </div>\n</div>\n\n'}),define("text!templates/CategoryTmpl.html",[],function(){return'<div class="arrow">{{name}}</div>\n'}),define("views/CategoryView",["text!templates/CategoryTmpl.html"],function(Tmpl){return Backbone.View.extend({tagName:"li",className:"arrow",events:{click:"goToDetails"},template:Tmpl,initialize:function(){_.bindAll(this,"render","goToDetails")},render:function(){return this.$el.html(Mustache.to_html(this.template,this.model.toJSON())),new ActiveButton(this.el),this},goToDetails:function(evt){return evt.preventDefault(),plogApp.router.navigate("activities/"+this.model.id,!0),!1}})}),define("views/CategoriesView",["text!templates/CategoriesTmpl.html","views/CategoryView"],function(Tmpl,CategoryView){return Backbone.View.extend({el:"#appContainer",tagName:"div",id:"categories",className:"viewWrapper",events:{},template:Tmpl,initialize:function(){_.bindAll(this,"render","getCategoriesSuccess","appendCategory")},render:function(){var data={title:"my resume"};return this.$el.html(Mustache.to_html(this.template,data)),$.setupScroll(this.$el),this.collection.length===0?this.collection.fetch({success:this.getCategoriesSuccess,error:this.getCategoriesError}):this.getCategoriesSuccess(this.collection),this},getCategoriesSuccess:function(collection){this.docFragment=document.createDocumentFragment(),_.each(collection.models,this.appendCategory),this.$el.find("ul").append(this.docFragment),$.refreshScroll(this.$el)},getCategoriesError:function(){alert("Cannot connect to server")},appendCategory:function(cat,ind){var view=new CategoryView({model:cat});this.docFragment.appendChild(view.render().el)}})}),define("models/Category",[],function(){return Backbone.Model.extend()}),define("collections/Categories",["models/Category"],function(Category){return Backbone.Collection.extend({model:Category,url:"/categories"})}),define("text!templates/ActivitiesTmpl.html",[],function(){return'<div class="toolbar">\n  <div class="back"></div>\n  <h1>{{title}}</h1>\n</div>\n<div class="wrapper">\n  <div class="scrollable">\n    <ul>\n    </ul>\n  </div>\n</div>\n\n'}),define("text!templates/ActivityTmpl.html",[],function(){return'<div {{#hasLink}}class="arrow"{{/hasLink}}>\n  <div class="actityTitle">\n    {{#hasLogo}}\n      <span class="isLogo">{{logo}}</span>&nbsp;\n    {{/hasLogo}}\n    {{title}}\n  </div>\n  <div class="actityDate">{{date}}</div>\n</div>\n\n'}),define("views/ActivityView",["text!templates/ActivityTmpl.html"],function(Tmpl){return Backbone.View.extend({tagName:"li",className:"",events:{click:"goToDetails"},template:Tmpl,initialize:function(){_.bindAll(this,"render","goToDetails")},render:function(){var data=this.model.toJSON();return data.hasLink=this.model.get("link")==="true",data.hasLogo=this.model.get("logo")!=="",this.$el.html(Mustache.to_html(this.template,data)),new ActiveButton(this.el),this},goToDetails:function(evt){return evt.preventDefault(),this.model.get("link")==="true"&&(this.model.get("target")===""?plogApp.router.navigate("details/"+this.model.id,!0):window.open(this.model.get("target"),"_blank")),!1}})}),define("views/ActivitiesView",["text!templates/ActivitiesTmpl.html","views/ActivityView"],function(Tmpl,ActivityView){return Backbone.View.extend({el:"#appContainer",tagName:"div",id:"activities",className:"viewWrapper",events:{},template:Tmpl,initialize:function(){_.bindAll(this,"render","getActivitiesSuccess","appendActivity")},render:function(){var data={title:this.options.title};return this.$el.html(Mustache.to_html(this.template,data)),$.setupScroll(this.$el),this.collection.length===0?this.collection.fetch({data:{catId:this.options.catId},success:this.getActivitiesSuccess,error:this.getActivitiesError}):this.getActivitiesSuccess(this.collection),new google.ui.FastButton(this.$el.find(".back").get(0),this.back),this},getActivitiesSuccess:function(collection){this.docFragment=document.createDocumentFragment(),_.each(collection.models,this.appendActivity),this.$el.find("ul").append(this.docFragment),$.refreshScroll(this.$el)},getActivitiesError:function(){alert("Cannot connect to server")},appendActivity:function(activity,ind){var view=new ActivityView({model:activity});this.docFragment.appendChild(view.render().el)},back:function(evt){return evt.preventDefault(),window.history.back(),!1}})}),define("models/Activity",[],function(){return Backbone.Model.extend()}),define("collections/Activities",["models/Activity"],function(Activity){return Backbone.Collection.extend({model:Activity,url:"/activities"})}),define("text!templates/DetailsTmpl.html",[],function(){return'<div class="toolbar">\n  <div class="back"></div>\n  <h1>{{title}}</h1>\n</div>\n<div class="wrapper">\n  <div class="scrollable">\n    <div class="activityDescription">{{description}}</div>\n    <ul id="detailsList">\n    </ul>\n  </div>\n</div>\n\n'}),define("text!templates/DetailTmpl.html",[],function(){return"<div>\n  {{text}}\n</div>\n\n"}),define("views/DetailView",["text!templates/DetailTmpl.html"],function(Tmpl){return Backbone.View.extend({tagName:"li",className:"",events:{},template:Tmpl,initialize:function(){_.bindAll(this,"render")},render:function(){return this.$el.html(Mustache.to_html(this.template,this.model.toJSON())),this}})}),define("views/DetailsView",["text!templates/DetailsTmpl.html","views/DetailView"],function(Tmpl,DetailView){return Backbone.View.extend({el:"#appContainer",tagName:"div",id:"details",className:"viewWrapper",events:{},template:Tmpl,initialize:function(){_.bindAll(this,"render","getDetailsSuccess","appendDetail")},render:function(){var data={title:this.options.title,description:this.options.description};return this.$el.html(Mustache.to_html(this.template,data)),this.$el.find("ul").hide(),$.setupScroll(this.$el),this.collection.length===0?this.collection.fetch({data:{activityId:this.options.activityId},success:this.getDetailsSuccess,error:this.getDetailsError}):this.getActivitiesSuccess(this.collection),new google.ui.FastButton(this.$el.find(".back").get(0),this.back),this},getDetailsSuccess:function(collection){this.docFragment=document.createDocumentFragment(),collection.length>0&&(this.$el.find("ul").show(),_.each(collection.models,this.appendDetail),this.$el.find("ul").append(this.docFragment),$.refreshScroll(this.$el))},getDetailsError:function(){alert("Cannot connect to server")},appendDetail:function(detail,ind){var view=new DetailView({model:detail});this.docFragment.appendChild(view.render().el)},back:function(evt){return evt.preventDefault(),window.history.back(),!1}})}),define("collections/Details",["models/Category"],function(Category){return Backbone.Collection.extend({model:Category,url:"/details"})}),define("routers/application_router",["views/CategoriesView","collections/Categories","views/ActivitiesView","collections/Activities","views/DetailsView","collections/Details"],function(CategoriesView,Categories,ActivitiesView,Activities,DetailsView,Details){var Router=Backbone.Router.extend({routes:{"":"categories","activities/:id":"activities","details/:id":"details"},categories:function(){return plogApp.categories||(plogApp.categories=new Categories),plogApp.CategoriesView||(plogApp.categoriesView=new CategoriesView({collection:plogApp.categories})),plogApp.categoriesView.render()},activities:function(id){if(!plogApp.categories){plogApp.router.navigate("",!0);return}var category=plogApp.categories.get(id),createView=plogApp.activitiesView===undefined||parseInt(id,10)!==plogApp.activitiesView.options.catId;return createView&&(plogApp.activities=new Activities,plogApp.activitiesView=new ActivitiesView({collection:plogApp.activities,catId:category.get("id"),title:category.get("name").toLowerCase()})),plogApp.activitiesView.render()},details:function(id){if(!plogApp.categories||!plogApp.activities){plogApp.router.navigate("",!0);return}var activity=plogApp.activities.get(id),createView=plogApp.detailsView===undefined||parseInt(id,10)!==plogApp.detailsView.options.activityId;return createView&&(plogApp.detailsView=new DetailsView({collection:new Details,description:activity.get("description"),title:activity.get("title").toLowerCase(),activityId:activity.get("id")})),plogApp.detailsView.render()}});return Router}),define("app",["domReady","routers/application_router"],function(domReady,ApplicationRouter){function launchApp(config){return domIsReady&&config.webapp||domIsReady&&deviceIsReady?($.initialize(config),plogApp.router=new ApplicationRouter,Backbone.history.start()):!1}window.plogApp=window.plogApp||{};var domIsReady=!1,deviceIsReady=!1,watchID=null,initialize=function(config){plogApp.config=config,domReady(function(){domIsReady=!0,launchApp(config)}),document.addEventListener("deviceready",function(){deviceIsReady=!0,launchApp(config)},!1)};return{initialize:initialize}}),define("config",[],function(){return{webapp:!0,cssMode:!0}}),function(){(function($){function setWrapperHeight(element){var height=windowHeight;return height-=_.reduce(element.find(".toolbar"),function(h,elt){return h+=$(elt).outerHeight()},0),element.find(".wrapper").css("height",height+"px")}function doOnOrientationChange(){switch(window.orientation){case-90:case 90:$("body").addClass("landscape");break;default:$("body").removeClass("landscape")}}var scroller,windowHeight,iScrollOptions={hScroll:!1,hScrollbar:!1,fadeScrollbar:!0,fixedScrollbar:!1};$.initialize=function(config){return scroller=null,windowHeight=window.innerHeight||460,document.body.addEventListener("touchmove",function(e){return e.preventDefault()}),window.onorientationchange=doOnOrientationChange,doOnOrientationChange(),config.cssMode&&window.less&&less.watch(),$("body")},$.setupScroll=function(element){var scrollable;element||(element=null);if(typeof iScroll=="undefined")return;scroller&&(scroller.destroy(),scroller=null),element||(element=$("body > div:first-child")),scrollable=element.find(".wrapper")[0];if(scrollable)return setTimeout(function(){setWrapperHeight(element),scroller=new iScroll(scrollable,iScrollOptions)},0),scroller},$.refreshScroll=function(){setTimeout(function(){scroller?scroller.refresh():$.setupScroll()},0)}})(jQuery)}.call(this),define("utils/iphone",function(){}),window.google=window.google||{},window.google.ui=window.google.ui||{},google.ui.FastButton=function(element,handler){this.element=element,this.handler=handler,element.addEventListener("touchstart",this,!1),element.addEventListener("click",this,!1)},google.ui.FastButton.prototype.handleEvent=function(event){switch(event.type){case"touchstart":$(this.element).addClass("active"),this.onTouchStart(event);break;case"touchmove":this.onTouchMove(event);break;case"touchend":$(this.element).removeClass("active"),this.onClick(event);break;case"click":$(this.element).addClass("active"),setTimeout(function(){$(this.element).removeClass("active")},100),this.onClick(event)}},google.ui.FastButton.prototype.onTouchStart=function(event){event.stopPropagation(),this.element.addEventListener("touchend",this,!1),document.body.addEventListener("touchmove",this,!1),this.startX=event.touches[0].clientX,this.startY=event.touches[0].clientY},google.ui.FastButton.prototype.onTouchMove=function(event){(Math.abs(event.touches[0].clientX-this.startX)>10||Math.abs(event.touches[0].clientY-this.startY)>10)&&this.reset()},google.ui.FastButton.prototype.onClick=function(event){event.stopPropagation(),this.reset(),this.handler(event),event.type=="touchend"&&google.clickbuster.preventGhostClick(this.startX,this.startY)},google.ui.FastButton.prototype.reset=function(){$(this.element).removeClass("active"),this.element.removeEventListener("touchend",this,!1),document.body.removeEventListener("touchmove",this,!1)},google.clickbuster={},google.clickbuster.preventGhostClick=function(x,y){google.clickbuster.coordinates.push(x,y),window.setTimeout(google.clickbuster.pop,2500)},google.clickbuster.pop=function(){google.clickbuster.coordinates.splice(0,2)},google.clickbuster.onClick=function(event){for(var i=0;i<google.clickbuster.coordinates.length;i+=2){var x=google.clickbuster.coordinates[i],y=google.clickbuster.coordinates[i+1];Math.abs(event.clientX-x)<25&&Math.abs(event.clientY-y)<25&&(event.stopPropagation(),event.preventDefault())}},document.addEventListener("click",google.clickbuster.onClick,!0),google.clickbuster.coordinates=[],window.ActiveButton=function(element){this.element=element,this.startX=0,this.startY=0,this.hasMoved=!1,this.touchHasFinished=!1,this.isActivated=!1,this.element.addEventListener("touchstart",this,!1),this.element.addEventListener("touchend",this,!1),this.element.addEventListener("touchmove",this,!1)},window.ActiveButton.prototype.handleEvent=function(event){switch(event.type){case"touchstart":this.onTouchStart(event);break;case"touchmove":this.onTouchMove(event);break;case"touchend":this.onTouchEnd(event)}},window.ActiveButton.prototype.onTouchStart=function(event){this.startX=event.touches[0].clientX,this.startY=event.touches[0].clientY,this.touchHasFinished=!1,this.isActivated=!1,this.hasMoved=!1;var that=this;setTimeout(function(){!that.hasMoved&&!that.touchHasFinished&&($(that.element).addClass("active"),that.isActivated=!0)},100)},window.ActiveButton.prototype.onTouchMove=function(event){if(Math.abs(event.touches[0].clientX-this.startX)>10||Math.abs(event.touches[0].clientY-this.startY)>10||this.hasMoved)this.hasMoved=!0;(Math.abs(event.touches[0].clientX-this.startX)>1||Math.abs(event.touches[0].clientY-this.startY)>1)&&this.isActivated&&$(this.element).removeClass("active")},window.ActiveButton.prototype.onTouchEnd=function(event){this.touchHasFinished=!0,$(this.element).removeClass("active")},define("utils/fast_button",function(){}),function(){var m=Math,mround=function(r){return r>>0},vendor=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",isAndroid=/android/gi.test(navigator.appVersion),isIDevice=/iphone|ipad/gi.test(navigator.appVersion),isPlaybook=/playbook/gi.test(navigator.appVersion),isTouchPad=/hp-tablet/gi.test(navigator.appVersion),has3d="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,hasTouch="ontouchstart"in window&&!isTouchPad,hasTransform=vendor+"Transform"in document.documentElement.style,hasTransitionEnd=isIDevice||isPlaybook,nextFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return setTimeout(callback,1)}}(),cancelFrame=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),RESIZE_EV="onorientationchange"in window?"orientationchange":"resize",START_EV=hasTouch?"touchstart":"mousedown",MOVE_EV=hasTouch?"touchmove":"mousemove",END_EV=hasTouch?"touchend":"mouseup",CANCEL_EV=hasTouch?"touchcancel":"mouseup",WHEEL_EV=vendor=="Moz"?"DOMMouseScroll":"mousewheel",trnOpen="translate"+(has3d?"3d(":"("),trnClose=has3d?",0)":")",iScroll=function(el,options){var that=this,doc=document,i;that.wrapper=typeof el=="object"?el:doc.getElementById(el),that.wrapper.style.overflow="hidden",that.scroller=that.wrapper.children[0],that.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:isAndroid,hideScrollbar:isIDevice,fadeScrollbar:isIDevice&&has3d,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(i in options)that.options[i]=options[i];that.x=that.options.x,that.y=that.options.y,that.options.useTransform=hasTransform?that.options.useTransform:!1,that.options.hScrollbar=that.options.hScroll&&that.options.hScrollbar,that.options.vScrollbar=that.options.vScroll&&that.options.vScrollbar,that.options.zoom=that.options.useTransform&&that.options.zoom,that.options.useTransition=hasTransitionEnd&&that.options.useTransition,that.options.zoom&&isAndroid&&(trnOpen="translate(",trnClose=")"),that.scroller.style[vendor+"TransitionProperty"]=that.options.useTransform?"-"+vendor.toLowerCase()+"-transform":"top left",that.scroller.style[vendor+"TransitionDuration"]="0",that.scroller.style[vendor+"TransformOrigin"]="0 0",that.options.useTransition&&(that.scroller.style[vendor+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),that.options.useTransform?that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose:that.scroller.style.cssText+=";position:absolute;top:"+that.y+"px;left:"+that.x+"px",that.options.useTransition&&(that.options.fixedScrollbar=!0),that.refresh(),that._bind(RESIZE_EV,window),that._bind(START_EV),hasTouch||(that._bind("mouseout",that.wrapper),that.options.wheelAction!="none"&&that._bind(WHEEL_EV)),that.options.checkDOMChanges&&(that.checkDOMTime=setInterval(function(){that._checkDOMChanges()},500))};iScroll.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var that=this;switch(e.type){case START_EV:if(!hasTouch&&e.button!==0)return;that._start(e);break;case MOVE_EV:that._move(e);break;case END_EV:case CANCEL_EV:that._end(e);break;case RESIZE_EV:that._resize();break;case WHEEL_EV:that._wheel(e);break;case"mouseout":that._mouseout(e);break;case"webkitTransitionEnd":that._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(dir){var that=this,doc=document,bar;if(!that[dir+"Scrollbar"]){that[dir+"ScrollbarWrapper"]&&(hasTransform&&(that[dir+"ScrollbarIndicator"].style[vendor+"Transform"]=""),that[dir+"ScrollbarWrapper"].parentNode.removeChild(that[dir+"ScrollbarWrapper"]),that[dir+"ScrollbarWrapper"]=null,that[dir+"ScrollbarIndicator"]=null);return}that[dir+"ScrollbarWrapper"]||(bar=doc.createElement("div"),that.options.scrollbarClass?bar.className=that.options.scrollbarClass+dir.toUpperCase():bar.style.cssText="position:absolute;z-index:100;"+(dir=="h"?"height:7px;bottom:1px;left:2px;right:"+(that.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(that.hScrollbar?"7":"2")+"px;top:2px;right:1px"),bar.style.cssText+=";pointer-events:none;-"+vendor+"-transition-property:opacity;-"+vendor+"-transition-duration:"+(that.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(that.options.hideScrollbar?"0":"1"),that.wrapper.appendChild(bar),that[dir+"ScrollbarWrapper"]=bar,bar=doc.createElement("div"),that.options.scrollbarClass||(bar.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+vendor+"-background-clip:padding-box;-"+vendor+"-box-sizing:border-box;"+(dir=="h"?"height:100%":"width:100%")+";-"+vendor+"-border-radius:3px;border-radius:3px"),bar.style.cssText+=";pointer-events:none;-"+vendor+"-transition-property:-"+vendor+"-transform;-"+vendor+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+vendor+"-transition-duration:0;-"+vendor+"-transform:"+trnOpen+"0,0"+trnClose,that.options.useTransition&&(bar.style.cssText+=";-"+vendor+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),that[dir+"ScrollbarWrapper"].appendChild(bar),that[dir+"ScrollbarIndicator"]=bar),dir=="h"?(that.hScrollbarSize=that.hScrollbarWrapper.clientWidth,that.hScrollbarIndicatorSize=m.max(mround(that.hScrollbarSize*that.hScrollbarSize/that.scrollerW),8),that.hScrollbarIndicator.style.width=that.hScrollbarIndicatorSize+"px",that.hScrollbarMaxScroll=that.hScrollbarSize-that.hScrollbarIndicatorSize,that.hScrollbarProp=that.hScrollbarMaxScroll/that.maxScrollX):(that.vScrollbarSize=that.vScrollbarWrapper.clientHeight,that.vScrollbarIndicatorSize=m.max(mround(that.vScrollbarSize*that.vScrollbarSize/that.scrollerH),8),that.vScrollbarIndicator.style.height=that.vScrollbarIndicatorSize+"px",that.vScrollbarMaxScroll=that.vScrollbarSize-that.vScrollbarIndicatorSize,that.vScrollbarProp=that.vScrollbarMaxScroll/that.maxScrollY),that._scrollbarPos(dir,!0)},_resize:function(){var that=this;setTimeout(function(){that.refresh()},isAndroid?200:0)},_pos:function(x,y){if(this.zoomed)return;x=this.hScroll?x:0,y=this.vScroll?y:0,this.options.useTransform?this.scroller.style[vendor+"Transform"]=trnOpen+x+"px,"+y+"px"+trnClose+" scale("+this.scale+")":(x=mround(x),y=mround(y),this.scroller.style.left=x+"px",this.scroller.style.top=y+"px"),this.x=x,this.y=y,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(dir,hidden){var that=this,pos=dir=="h"?that.x:that.y,size;if(!that[dir+"Scrollbar"])return;pos=that[dir+"ScrollbarProp"]*pos,pos<0?(that.options.fixedScrollbar||(size=that[dir+"ScrollbarIndicatorSize"]+mround(pos*3),size<8&&(size=8),that[dir+"ScrollbarIndicator"].style[dir=="h"?"width":"height"]=size+"px"),pos=0):pos>that[dir+"ScrollbarMaxScroll"]&&(that.options.fixedScrollbar?pos=that[dir+"ScrollbarMaxScroll"]:(size=that[dir+"ScrollbarIndicatorSize"]-mround((pos-that[dir+"ScrollbarMaxScroll"])*3),size<8&&(size=8),that[dir+"ScrollbarIndicator"].style[dir=="h"?"width":"height"]=size+"px",pos=that[dir+"ScrollbarMaxScroll"]+(that[dir+"ScrollbarIndicatorSize"]-size))),that[dir+"ScrollbarWrapper"].style[vendor+"TransitionDelay"]="0",that[dir+"ScrollbarWrapper"].style.opacity=hidden&&that.options.hideScrollbar?"0":"1",that[dir+"ScrollbarIndicator"].style[vendor+"Transform"]=trnOpen+(dir=="h"?pos+"px,0":"0,"+pos+"px")+trnClose},_start:function(e){var that=this,point=hasTouch?e.touches[0]:e,matrix,x,y,c1,c2;if(!that.enabled)return;that.options.onBeforeScrollStart&&that.options.onBeforeScrollStart.call(that,e),(that.options.useTransition||that.options.zoom)&&that._transitionTime(0),that.moved=!1,that.animating=!1,that.zoomed=!1,that.distX=0,that.distY=0,that.absDistX=0,that.absDistY=0,that.dirX=0,that.dirY=0,that.options.zoom&&hasTouch&&e.touches.length>1&&(c1=m.abs(e.touches[0].pageX-e.touches[1].pageX),c2=m.abs(e.touches[0].pageY-e.touches[1].pageY),that.touchesDistStart=m.sqrt(c1*c1+c2*c2),that.originX=m.abs(e.touches[0].pageX+e.touches[1].pageX-that.wrapperOffsetLeft*2)/2-that.x,that.originY=m.abs(e.touches[0].pageY+e.touches[1].pageY-that.wrapperOffsetTop*2)/2-that.y,that.options.onZoomStart&&that.options.onZoomStart.call(that,e));if(that.options.momentum){that.options.useTransform?(matrix=getComputedStyle(that.scroller,null)[vendor+"Transform"].replace(/[^0-9-.,]/g,"").split(","),x=matrix[4]*1,y=matrix[5]*1):(x=getComputedStyle(that.scroller,null).left.replace(/[^0-9-]/g,"")*1,y=getComputedStyle(that.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(x!=that.x||y!=that.y)that.options.useTransition?that._unbind("webkitTransitionEnd"):cancelFrame(that.aniTime),that.steps=[],that._pos(x,y)}that.absStartX=that.x,that.absStartY=that.y,that.startX=that.x,that.startY=that.y,that.pointX=point.pageX,that.pointY=point.pageY,that.startTime=e.timeStamp||Date.now(),that.options.onScrollStart&&that.options.onScrollStart.call(that,e),that._bind(MOVE_EV),that._bind(END_EV),that._bind(CANCEL_EV)},_move:function(e){var that=this,point=hasTouch?e.touches[0]:e,deltaX=point.pageX-that.pointX,deltaY=point.pageY-that.pointY,newX=that.x+deltaX,newY=that.y+deltaY,c1,c2,scale,timestamp=e.timeStamp||Date.now();that.options.onBeforeScrollMove&&that.options.onBeforeScrollMove.call(that,e);if(that.options.zoom&&hasTouch&&e.touches.length>1){c1=m.abs(e.touches[0].pageX-e.touches[1].pageX),c2=m.abs(e.touches[0].pageY-e.touches[1].pageY),that.touchesDist=m.sqrt(c1*c1+c2*c2),that.zoomed=!0,scale=1/that.touchesDistStart*that.touchesDist*this.scale,scale<that.options.zoomMin?scale=.5*that.options.zoomMin*Math.pow(2,scale/that.options.zoomMin):scale>that.options.zoomMax&&(scale=2*that.options.zoomMax*Math.pow(.5,that.options.zoomMax/scale)),that.lastScale=scale/this.scale,newX=this.originX-this.originX*that.lastScale+this.x,newY=this.originY-this.originY*that.lastScale+this.y,this.scroller.style[vendor+"Transform"]=trnOpen+newX+"px,"+newY+"px"+trnClose+" scale("+scale+")",that.options.onZoom&&that.options.onZoom.call(that,e);return}that.pointX=point.pageX,that.pointY=point.pageY;if(newX>0||newX<that.maxScrollX)newX=that.options.bounce?that.x+deltaX/2:newX>=0||that.maxScrollX>=0?0:that.maxScrollX;if(newY>that.minScrollY||newY<that.maxScrollY)newY=that.options.bounce?that.y+deltaY/2:newY>=that.minScrollY||that.maxScrollY>=0?that.minScrollY:that.maxScrollY;that.distX+=deltaX,that.distY+=deltaY,that.absDistX=m.abs(that.distX),that.absDistY=m.abs(that.distY);if(that.absDistX<6&&that.absDistY<6)return;that.options.lockDirection&&(that.absDistX>that.absDistY+5?(newY=that.y,deltaY=0):that.absDistY>that.absDistX+5&&(newX=that.x,deltaX=0)),that.moved=!0,that._pos(newX,newY),that.dirX=deltaX>0?-1:deltaX<0?1:0,that.dirY=deltaY>0?-1:deltaY<0?1:0,timestamp-that.startTime>300&&(that.startTime=timestamp,that.startX=that.x,that.startY=that.y),that.options.onScrollMove&&that.options.onScrollMove.call(that,e)},_end:function(e){if(hasTouch&&e.touches.length!=0)return;var that=this,point=hasTouch?e.changedTouches[0]:e,target,ev,momentumX={dist:0,time:0},momentumY={dist:0,time:0},duration=(e.timeStamp||Date.now())-that.startTime,newPosX=that.x,newPosY=that.y,distX,distY,newDuration,snap,scale;that._unbind(MOVE_EV),that._unbind(END_EV),that._unbind(CANCEL_EV),that.options.onBeforeScrollEnd&&that.options.onBeforeScrollEnd.call(that,e);if(that.zoomed){scale=that.scale*that.lastScale,scale=Math.max(that.options.zoomMin,scale),scale=Math.min(that.options.zoomMax,scale),that.lastScale=scale/that.scale,that.scale=scale,that.x=that.originX-that.originX*that.lastScale+that.x,that.y=that.originY-that.originY*that.lastScale+that.y,that.scroller.style[vendor+"TransitionDuration"]="200ms",that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose+" scale("+that.scale+")",that.zoomed=!1,that.refresh(),that.options.onZoomEnd&&that.options.onZoomEnd.call(that,e);return}if(!that.moved){hasTouch&&(that.doubleTapTimer&&that.options.zoom?(clearTimeout(that.doubleTapTimer),that.doubleTapTimer=null,that.options.onZoomStart&&that.options.onZoomStart.call(that,e),that.zoom(that.pointX,that.pointY,that.scale==1?that.options.doubleTapZoom:1),that.options.onZoomEnd&&setTimeout(function(){that.options.onZoomEnd.call(that,e)},200)):this.options.handleClick&&(that.doubleTapTimer=setTimeout(function(){that.doubleTapTimer=null,target=point.target;while(target.nodeType!=1)target=target.parentNode;target.tagName!="SELECT"&&target.tagName!="INPUT"&&target.tagName!="TEXTAREA"&&(ev=document.createEvent("MouseEvents"),ev.initMouseEvent("click",!0,!0,e.view,1,point.screenX,point.screenY,point.clientX,point.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),ev._fake=!0,target.dispatchEvent(ev))},that.options.zoom?250:0))),that._resetPos(200),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}if(duration<300&&that.options.momentum){momentumX=newPosX?that._momentum(newPosX-that.startX,duration,-that.x,that.scrollerW-that.wrapperW+that.x,that.options.bounce?that.wrapperW:0):momentumX,momentumY=newPosY?that._momentum(newPosY-that.startY,duration,-that.y,that.maxScrollY<0?that.scrollerH-that.wrapperH+that.y-that.minScrollY:0,that.options.bounce?that.wrapperH:0):momentumY,newPosX=that.x+momentumX.dist,newPosY=that.y+momentumY.dist;if(that.x>0&&newPosX>0||that.x<that.maxScrollX&&newPosX<that.maxScrollX)momentumX={dist:0,time:0};if(that.y>that.minScrollY&&newPosY>that.minScrollY||that.y<that.maxScrollY&&newPosY<that.maxScrollY)momentumY={dist:0,time:0}}if(momentumX.dist||momentumY.dist){newDuration=m.max(m.max(momentumX.time,momentumY.time),10),that.options.snap&&(distX=newPosX-that.absStartX,distY=newPosY-that.absStartY,m.abs(distX)<that.options.snapThreshold&&m.abs(distY)<that.options.snapThreshold?that.scrollTo(that.absStartX,that.absStartY,200):(snap=that._snap(newPosX,newPosY),newPosX=snap.x,newPosY=snap.y,newDuration=m.max(snap.time,newDuration))),that.scrollTo(mround(newPosX),mround(newPosY),newDuration),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}if(that.options.snap){distX=newPosX-that.absStartX,distY=newPosY-that.absStartY,m.abs(distX)<that.options.snapThreshold&&m.abs(distY)<that.options.snapThreshold?that.scrollTo(that.absStartX,that.absStartY,200):(snap=that._snap(that.x,that.y),(snap.x!=that.x||snap.y!=that.y)&&that.scrollTo(snap.x,snap.y,snap.time)),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}that._resetPos(200),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e)},_resetPos:function(time){var that=this,resetX=that.x>=0?0:that.x<that.maxScrollX?that.maxScrollX:that.x,resetY=that.y>=that.minScrollY||that.maxScrollY>0?that.minScrollY:that.y<that.maxScrollY?that.maxScrollY:that.y;if(resetX==that.x&&resetY==that.y){that.moved&&(that.moved=!1,that.options.onScrollEnd&&that.options.onScrollEnd.call(that)),that.hScrollbar&&that.options.hideScrollbar&&(vendor=="webkit"&&(that.hScrollbarWrapper.style[vendor+"TransitionDelay"]="300ms"),that.hScrollbarWrapper.style.opacity="0"),that.vScrollbar&&that.options.hideScrollbar&&(vendor=="webkit"&&(that.vScrollbarWrapper.style[vendor+"TransitionDelay"]="300ms"),that.vScrollbarWrapper.style.opacity="0");return}that.scrollTo(resetX,resetY,time||0)},_wheel:function(e){var that=this,wheelDeltaX,wheelDeltaY,deltaX,deltaY,deltaScale;if("wheelDeltaX"in e)wheelDeltaX=e.wheelDeltaX/12,wheelDeltaY=e.wheelDeltaY/12;else if("wheelDelta"in e)wheelDeltaX=wheelDeltaY=e.wheelDelta/12;else{if(!("detail"in e))return;wheelDeltaX=wheelDeltaY=-e.detail*3}if(that.options.wheelAction=="zoom"){deltaScale=that.scale*Math.pow(2,1/3*(wheelDeltaY?wheelDeltaY/Math.abs(wheelDeltaY):0)),deltaScale<that.options.zoomMin&&(deltaScale=that.options.zoomMin),deltaScale>that.options.zoomMax&&(deltaScale=that.options.zoomMax),deltaScale!=that.scale&&(!that.wheelZoomCount&&that.options.onZoomStart&&that.options.onZoomStart.call(that,e),that.wheelZoomCount++,that.zoom(e.pageX,e.pageY,deltaScale,400),setTimeout(function(){that.wheelZoomCount--,!that.wheelZoomCount&&that.options.onZoomEnd&&that.options.onZoomEnd.call(that,e)},400));return}deltaX=that.x+wheelDeltaX,deltaY=that.y+wheelDeltaY,deltaX>0?deltaX=0:deltaX<that.maxScrollX&&(deltaX=that.maxScrollX),deltaY>that.minScrollY?deltaY=that.minScrollY:deltaY<that.maxScrollY&&(deltaY=that.maxScrollY),that.maxScrollY<0&&that.scrollTo(deltaX,deltaY,0)},_mouseout:function(e){var t=e.relatedTarget;if(!t){this._end(e);return}while(t=t.parentNode)if(t==this.wrapper)return;this._end(e)},_transitionEnd:function(e){var that=this;if(e.target!=that.scroller)return;that._unbind("webkitTransitionEnd"),that._startAni()},_startAni:function(){var that=this,startX=that.x,startY=that.y,startTime=Date.now(),step,easeOut,animate;if(that.animating)return;if(!that.steps.length){that._resetPos(400);return}step=that.steps.shift(),step.x==startX&&step.y==startY&&(step.time=0),that.animating=!0,that.moved=!0;if(that.options.useTransition){that._transitionTime(step.time),that._pos(step.x,step.y),that.animating=!1,step.time?that._bind("webkitTransitionEnd"):that._resetPos(0);return}animate=function(){var now=Date.now(),newX,newY;if(now>=startTime+step.time){that._pos(step.x,step.y),that.animating=!1,that.options.onAnimationEnd&&that.options.onAnimationEnd.call(that),that._startAni();return}now=(now-startTime)/step.time-1,easeOut=m.sqrt(1-now*now),newX=(step.x-startX)*easeOut+startX,newY=(step.y-startY)*easeOut+startY,that._pos(newX,newY),that.animating&&(that.aniTime=nextFrame(animate))},animate()},_transitionTime:function(time){time+="ms",this.scroller.style[vendor+"TransitionDuration"]=time,this.hScrollbar&&(this.hScrollbarIndicator.style[vendor+"TransitionDuration"]=time),this.vScrollbar&&(this.vScrollbarIndicator.style[vendor+"TransitionDuration"]=time)},_momentum:function(dist,time,maxDistUpper,maxDistLower,size){var deceleration=6e-4,speed=m.abs(dist)/time,newDist=speed*speed/(2*deceleration),newTime=0,outsideDist=0;return dist>0&&newDist>maxDistUpper?(outsideDist=size/(6/(newDist/speed*deceleration)),maxDistUpper+=outsideDist,speed=speed*maxDistUpper/newDist,newDist=maxDistUpper):dist<0&&newDist>maxDistLower&&(outsideDist=size/(6/(newDist/speed*deceleration)),maxDistLower+=outsideDist,speed=speed*maxDistLower/newDist,newDist=maxDistLower),newDist*=dist<0?-1:1,newTime=speed/deceleration,{dist:newDist,time:mround(newTime)}},_offset:function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent)left-=el.offsetLeft,top-=el.offsetTop;return el!=this.wrapper&&(left*=this.scale,top*=this.scale),{left:left,top:top}},_snap:function(x,y){var that=this,i,l,page,time,sizeX,sizeY;page=that.pagesX.length-1;for(i=0,l=that.pagesX.length;i<l;i++)if(x>=that.pagesX[i]){page=i;break}page==that.currPageX&&page>0&&that.dirX<0&&page--,x=that.pagesX[page],sizeX=m.abs(x-that.pagesX[that.currPageX]),sizeX=sizeX?m.abs(that.x-x)/sizeX*500:0,that.currPageX=page,page=that.pagesY.length-1;for(i=0;i<page;i++)if(y>=that.pagesY[i]){page=i;break}return page==that.currPageY&&page>0&&that.dirY<0&&page--,y=that.pagesY[page],sizeY=m.abs(y-that.pagesY[that.currPageY]),sizeY=sizeY?m.abs(that.y-y)/sizeY*500:0,that.currPageY=page,time=mround(m.max(sizeX,sizeY))||200,{x:x,y:y,time:time}},_bind:function(type,el,bubble){(el||this.scroller).addEventListener(type,this,!!bubble)},_unbind:function(type,el,bubble){(el||this.scroller).removeEventListener(type,this,!!bubble)},destroy:function(){var that=this;that.scroller.style[vendor+"Transform"]="",that.hScrollbar=!1,that.vScrollbar=!1,that._scrollbar("h"),that._scrollbar("v"),that._unbind(RESIZE_EV,window),that._unbind(START_EV),that._unbind(MOVE_EV),that._unbind(END_EV),that._unbind(CANCEL_EV),that.options.hasTouch||(that._unbind("mouseout",that.wrapper),that._unbind(WHEEL_EV)),that.options.useTransition&&that._unbind("webkitTransitionEnd"),that.options.checkDOMChanges&&clearInterval(that.checkDOMTime),that.options.onDestroy&&that.options.onDestroy.call(that)},refresh:function(){var that=this,offset,i,l,els,pos=0,page=0;that.scale<that.options.zoomMin&&(that.scale=that.options.zoomMin),that.wrapperW=that.wrapper.clientWidth||1,that.wrapperH=that.wrapper.clientHeight||1,that.minScrollY=-that.options.topOffset||0,that.scrollerW=mround(that.scroller.offsetWidth*that.scale),that.scrollerH=mround((that.scroller.offsetHeight+that.minScrollY)*that.scale),that.maxScrollX=that.wrapperW-that.scrollerW,that.maxScrollY=that.wrapperH-that.scrollerH+that.minScrollY,that.dirX=0,that.dirY=0,that.options.onRefresh&&that.options.onRefresh.call(that),that.hScroll=that.options.hScroll&&that.maxScrollX<0,that.vScroll=that.options.vScroll&&(!that.options.bounceLock&&!that.hScroll||that.scrollerH>that.wrapperH),that.hScrollbar=that.hScroll&&that.options.hScrollbar,that.vScrollbar=that.vScroll&&that.options.vScrollbar&&that.scrollerH>that.wrapperH,offset=that._offset(that.wrapper),that.wrapperOffsetLeft=-offset.left,that.wrapperOffsetTop=-offset.top;if(typeof that.options.snap=="string"){that.pagesX=[],that.pagesY=[],els=that.scroller.querySelectorAll(that.options.snap);for(i=0,l=els.length;i<l;i++)pos=that._offset(els[i]),pos.left+=that.wrapperOffsetLeft,pos.top+=that.wrapperOffsetTop,that.pagesX[i]=pos.left<that.maxScrollX?that.maxScrollX:pos.left*that.scale,that.pagesY[i]=pos.top<that.maxScrollY?that.maxScrollY:pos.top*that.scale}else if(that.options.snap){that.pagesX=[];while(pos>=that.maxScrollX)that.pagesX[page]=pos,pos-=that.wrapperW,page++;that.maxScrollX%that.wrapperW&&(that.pagesX[that.pagesX.length]=that.maxScrollX-that.pagesX[that.pagesX.length-1]+that.pagesX[that.pagesX.length-1]),pos=0,page=0,that.pagesY=[];while(pos>=that.maxScrollY)that.pagesY[page]=pos,pos-=that.wrapperH,page++;that.maxScrollY%that.wrapperH&&(that.pagesY[that.pagesY.length]=that.maxScrollY-that.pagesY[that.pagesY.length-1]+that.pagesY[that.pagesY.length-1])}that._scrollbar("h"),that._scrollbar("v"),that.zoomed||(that.scroller.style[vendor+"TransitionDuration"]="0",that._resetPos(200))},scrollTo:function(x,y,time,relative){var that=this,step=x,i,l;that.stop(),step.length||(step=[{x:x,y:y,time:time,relative:relative}]);for(i=0,l=step.length;i<l;i++)step[i].relative&&(step[i].x=that.x-step[i].x,step[i].y=that.y-step[i].y),that.steps.push({x:step[i].x,y:step[i].y,time:step[i].time||0});that._startAni()},scrollToElement:function(el,time){var that=this,pos;el=el.nodeType?el:that.scroller.querySelector(el);if(!el)return;pos=that._offset(el),pos.left+=that.wrapperOffsetLeft,pos.top+=that.wrapperOffsetTop,pos.left=pos.left>0?0:pos.left<that.maxScrollX?that.maxScrollX:pos.left,pos.top=pos.top>that.minScrollY?that.minScrollY:pos.top<that.maxScrollY?that.maxScrollY:pos.top,time=time===undefined?m.max(m.abs(pos.left)*2,m.abs(pos.top)*2):time,that.scrollTo(pos.left,pos.top,time)},scrollToPage:function(pageX,pageY,time){var that=this,x,y;time=time===undefined?400:time,that.options.onScrollStart&&that.options.onScrollStart.call(that),that.options.snap?(pageX=pageX=="next"?that.currPageX+1:pageX=="prev"?that.currPageX-1:pageX,pageY=pageY=="next"?that.currPageY+1:pageY=="prev"?that.currPageY-1:pageY,pageX=pageX<0?0:pageX>that.pagesX.length-1?that.pagesX.length-1:pageX,pageY=pageY<0?0:pageY>that.pagesY.length-1?that.pagesY.length-1:pageY,that.currPageX=pageX,that.currPageY=pageY,x=that.pagesX[pageX],y=that.pagesY[pageY]):(x=-that.wrapperW*pageX,y=-that.wrapperH*pageY,x<that.maxScrollX&&(x=that.maxScrollX),y<that.maxScrollY&&(y=that.maxScrollY)),that.scrollTo(x,y,time)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(MOVE_EV),this._unbind(END_EV),this._unbind(CANCEL_EV)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):cancelFrame(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(x,y,scale,time){var that=this,relScale=scale/that.scale;if(!that.options.useTransform)return;that.zoomed=!0,time=time===undefined?200:time,x=x-that.wrapperOffsetLeft-that.x,y=y-that.wrapperOffsetTop-that.y,that.x=x-x*relScale+that.x,that.y=y-y*relScale+that.y,that.scale=scale,that.refresh(),that.x=that.x>0?0:that.x<that.maxScrollX?that.maxScrollX:that.x,that.y=that.y>that.minScrollY?that.minScrollY:that.y<that.maxScrollY?that.maxScrollY:that.y,that.scroller.style[vendor+"TransitionDuration"]=time+"ms",that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose+" scale("+scale+")",that.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},typeof exports!="undefined"?exports.iScroll=iScroll:window.iScroll=iScroll}(),define("../js/iscroll",function(){});var Mustache=typeof module!="undefined"&&module.exports||{};(function(exports){function isWhitespace(string){return spaceRe.test(string)}function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s})}function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end),c;for(var i=0,len=context.length;i<len;++i)c=i+start+1,context[i]=(c===line?" >> ":"    ")+context[i];return e.template=template,e.line=line,e.file=file,e.message=[file+":"+line,context.join("\n"),"",e.message].join("\n"),e}function lookup(name,stack,defaultValue){if(name===".")return stack[stack.length-1];var names=name.split("."),lastIndex=names.length-1,target=names[lastIndex],value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0),context=stack[--i],j=0;while(j<lastIndex){context=context[names[j++]];if(context==null)break;localStack.push(context)}if(context&&typeof context=="object"&&target in context){value=context[target];break}}return typeof value=="function"&&(value=value.call(localStack[localStack.length-1])),value==null?defaultValue:value}function renderSection(name,stack,callback,inverted){var buffer="",value=lookup(name,stack);if(inverted){if(value==null||value===!1||isArray(value)&&value.length===0)buffer+=callback()}else if(isArray(value))forEach(value,function(value){stack.push(value),buffer+=callback(),stack.pop()});else if(typeof value=="object")stack.push(value),buffer+=callback(),stack.pop();else if(typeof value=="function"){var scope=stack[stack.length-1],scopedRender=function(template){return render(template,scope)};buffer+=value.call(scope,callback(),scopedRender)||""}else value&&(buffer+=callback());return buffer}function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1],code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],spaces=[],hasTag=!1,nonSpace=!1,stripSpace=function(){if(hasTag&&!nonSpace&&!options.space)while(spaces.length)code.splice(spaces.pop(),1);else spaces=[];hasTag=!1,nonSpace=!1},sectionStack=[],updateLine,nextOpenTag,nextCloseTag,setTags=function(source){tags=trim(source).split(/\s+/),nextOpenTag=tags[0],nextCloseTag=tags[tags.length-1]},includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},openSection=function(source,inverted){var name=trim(source);if(name==="")throw debug(new Error("Section name may not be empty"),template,line,options.file);sectionStack.push({name:name,inverted:inverted}),code.push('";',updateLine,'\nvar name = "'+name+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},openInvertedSection=function(source){openSection(source,!0)},closeSection=function(source){var name=trim(source),openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName)throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);var section=sectionStack.pop();code.push('";',"\n    return buffer;","\n  };","\n})();"),section.inverted?code.push("\nbuffer += renderSection(name,stack,callback,true);"):code.push("\nbuffer += renderSection(name,stack,callback);"),code.push('\nbuffer += "')},sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(source)+'",stack,"");','\nbuffer += "')},sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "')},line=1,c,callback;for(var i=0,len=template.length;i<len;++i)if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length,c=template.substr(i,1),updateLine="\nline = "+line+";",nextOpenTag=openTag,nextCloseTag=closeTag,hasTag=!0;switch(c){case"!":i++,callback=null;break;case"=":i++,closeTag="="+closeTag,callback=setTags;break;case">":i++,callback=includePartial;break;case"#":i++,callback=openSection;break;case"^":i++,callback=openInvertedSection;break;case"/":i++,callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++,nonSpace=!0,callback=sendPlain;break;default:nonSpace=!0,callback=sendEscaped}var end=template.indexOf(closeTag,i);if(end===-1)throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);var source=template.substring(i,end);callback&&callback(source);var n=0;while(~(n=source.indexOf("\n",n)))line++,n++;i=end+closeTag.length-1,openTag=nextOpenTag,closeTag=nextCloseTag}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=!0,code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length),code.push("\\n"),stripSpace(),line++;break;default:isWhitespace(c)?spaces.push(code.length):nonSpace=!0,code.push(c)}}if(sectionStack.length!=0)throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);stripSpace(),code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");return options.debug&&(typeof console!="undefined"&&console.log?console.log(body):typeof print=="function"&&print(body)),body}function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render",body=parse(template,options),fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render)}catch(e){throw debug(e.error,template,e.line,options.file)}}}function clearCache(){_cache={}}function compile(template,options){return options=options||{},options.cache!==!1?(_cache[template]||(_cache[template]=_compile(template,options)),_cache[template]):_compile(template,options)}function render(template,view,partials){return compile(template)(view,partials)}exports.name="mustache.js",exports.version="0.5.0-dev",exports.tags=["{{","}}"],exports.parse=parse,exports.compile=compile,exports.render=render,exports.clearCache=clearCache,exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send!="function")return result;send(result)};var _toString=Object.prototype.toString,_isArray=Array.isArray,_forEach=Array.prototype.forEach,_trim=String.prototype.trim,isArray;_isArray?isArray=_isArray:isArray=function(obj){return _toString.call(obj)==="[object Array]"};var forEach;_forEach?forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope)}:forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i)callback.call(scope,obj[i],i,obj)};var spaceRe=/^\s*$/,trim;if(_trim)trim=function(string){return string==null?"":_trim.call(string)};else{var trimLeft,trimRight;isWhitespace("Â ")?(trimLeft=/^\s+/,trimRight=/\s+$/):(trimLeft=/^[\s\xA0]+/,trimRight=/[\s\xA0]+$/),trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"")}}var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_cache={}})(Mustache),define("../js/mustache",function(){}),require.config({paths:{text:"../js/requirejs/text",domReady:"../js/requirejs/domReady"},baseUrl:"./app"}),require(["app","config","utils/iphone","utils/fast_button","../js/iscroll","../js/mustache"],function(App,Config){App.initialize(Config)}),define("main",function(){})})()